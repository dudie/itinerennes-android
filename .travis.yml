language: java
jdk: openjdk6
env:
  matrix:
  # Eclair 2.1
  - ANDROID_SDKS=android-7            ANDROID_TARGET=android-7   ANDROID_ABI=armeabi

before_install:
# Install base Android SDK
- sudo apt-get update -qq
- if [ `uname -m` = x86_64 ]; then sudo apt-get install -qq --force-yes libgd2-xpm ia32-libs ia32-libs-multiarch; fi
- wget http://dl.google.com/android/android-sdk_r22.3-linux.tgz -O android-sdk-linux.tgz
- tar xzf android-sdk-linux.tgz
- export ANDROID_HOME=$PWD/android-sdk-linux
- export PATH=${PATH}:${ANDROID_HOME}/tools:${ANDROID_HOME}/platform-tools

# Install required Android components.
- echo y | android update sdk --filter build-tools-19.0.0,platform-tools,extra-android-support,android-7,$ANDROID_SDKS --no-ui --all --force

# Create and start emulator
- echo no | android create avd --force -n test -t $ANDROID_TARGET --abi $ANDROID_ABI
- emulator -avd test -no-skin -no-audio -no-window &

before_script:
# Make sure the emulator has started before running tests
- ./.travis/wait_for_emulator.sh

script: mvn install -Dandroid.device=test
